(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-90d0c598"],{"1f34":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-header-index-wide"},[a("a-modal",{attrs:{title:"详情",visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"登录账号",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入登录账号!"}]}],expression:"[\n            'name',\n            {\n              rules: [{ required: true, message: '请输入登录账号!' }]\n            }\n          ]"}],attrs:{readonly:0!==this.selected,placeholder:"请入登录账号"}})],1),a("a-form-item",{attrs:{label:"登录密码",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:0===this.selected,message:"请输入登录密码!"}]}],expression:"[\n            'password',\n            {\n              rules: [{ required: this.selected === 0, message: '请输入登录密码!' }]\n            }\n          ]"}],attrs:{placeholder:0===this.selected?"请入登录密码":"如需修改密码请输入新密码"}})],1),a("a-form-item",{attrs:{label:"用户昵称",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["nickname",{rules:[{required:!0,message:"请输入用户名称!"}]}],expression:"[\n            'nickname',\n            {\n              rules: [{ required: true, message: '请输入用户名称!' }]\n            }\n          ]"}],attrs:{placeholder:"请入用户昵称"}})],1),a("a-form-item",{attrs:{label:"归属部门",hasFeedback:""}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["dept_id",{rules:[{required:!0,message:"请选择归属部门!"}]}],expression:"[\n            'dept_id',\n            {\n              rules: [{ required: true, message: '请选择归属部门!' }]\n            }\n          ]"}],attrs:{dropdownStyle:{maxHeight:"400px",overflow:"auto"},treeData:e.depts,placeholder:"请选择角色",treeDefaultExpandAll:""},on:{select:e.onSelect}})],1),a("a-form-item",{attrs:{label:"选择角色",hasFeedback:""}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["roles",{rules:[{required:!0,message:"请选择角色!"}]}],expression:"[\n            'roles',\n            {\n              rules: [{ required: true, message: '请选择角色!' }]\n            }\n          ]"}],attrs:{dropdownStyle:{maxHeight:"400px",overflow:"auto"},treeData:e.roles,placeholder:"请选择角色",treeDefaultExpandAll:"",multiple:""}})],1),a("a-form-item",{attrs:{label:"状态",hasFeedback:""}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{rules:[{required:!0,message:"请选择状态!"}]}],expression:"[\n            'status',\n            {\n              rules: [{ required: true, message: '请选择状态!' }]\n            }\n          ]"}],attrs:{placeholder:"请选择"}},[a("a-select-option",{attrs:{value:1}},[e._v(" 正常 ")]),a("a-select-option",{attrs:{value:0}},[e._v(" 禁用 ")])],1)],1)],1)],1),a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{xs:{span:24},lg:4}},[a("a-card",{attrs:{"body-style":{padding:"0 24px"}}},[a("a-tree",{attrs:{expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,selectedKeys:e.selectedKeys,treeData:e.depts},on:{expand:e.onExpand,select:e.onSelects},model:{value:e.checkedKeys,callback:function(t){e.checkedKeys=t},expression:"checkedKeys"}})],1)],1),a("a-col",{attrs:{xs:{span:24},lg:20}},[a("a-card",{attrs:{"body-style":{padding:0}}},[a("div",{staticClass:"ant-pro-table-toolbar"},[a("div",{staticClass:"ant-pro-table-toolbar-title"}),a("div",{staticClass:"ant-pro-table-toolbar-option"},[a("div",{staticClass:"ant-pro-table-toolbar-item"},[a("a-button",{attrs:{type:"primary",icon:"plus",loading:e.loading},on:{click:function(t){e.visible=!0}}},[e._v("新建")])],1),e.selectedRows.length?[a("div",{staticClass:"ant-pro-table-toolbar-item"},[a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},on:{click:e.handleMenuClick},slot:"overlay"},[a("a-menu-item",{key:"remove"},[a("a-icon",{attrs:{type:"delete"}}),e._v("批量删除")],1)],1),a("a-button",{staticStyle:{"margin-left":"8px"}},[e._v(" 批量操作 "),a("a-icon",{attrs:{type:"down"}})],1)],1)],1)]:e._e(),a("a-divider",{attrs:{type:"vertical"}}),a("span",{staticClass:"ant-pro-table-toolbar-item-icon"},[a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[a("span",[e._v("刷新")])]),a("a-icon",{attrs:{type:"reload"},on:{click:function(t){return e.refreshTable()}}})],2)],1)],2)]),a("s-table",{ref:"table",attrs:{size:"default",rowKey:function(e){return e.id},columns:e.columns,data:e.loadData,alert:!0,expandRowByClick:!0,expandIcon:e.expandIcon,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},scopedSlots:e._u([{key:"dept",fn:function(t){return[a("a-tag",{attrs:{color:"purple"}},[e._v(e._s(t.dept_name))])]}},{key:"status",fn:function(t){return[1===t.status?[e._v("正常")]:[e._v("禁用")]]}},{key:"expandedRowRender",fn:function(t){return[a("a-row",e._l(e.rules,(function(n,s){return a("a-col",{key:s,staticClass:"rule-list",attrs:{span:"12"}},[a("a-row",[a("a-col",{attrs:{span:"4"}},[e._v(e._s(n.title)+"：")]),a("a-col",{attrs:{span:"20"}},[n.actions.length?e._e():[e._v("-")],e._l(n.actions,(function(n,s){return[-1!==t.rules.indexOf(n.id)?a("a-tag",{key:s},[e._v(" "+e._s(n.title)+" ")]):e._e()]}))],2)],1)],1)})),1)]}},{key:"tools",fn:function(t){return[a("a",{directives:[{name:"action",rawName:"v-action:AccountUpdate",arg:"AccountUpdate"}],on:{click:function(a){return e.openInfoModal(t)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{directives:[{name:"action",rawName:"v-action:AccountDelete",arg:"AccountDelete"}],on:{click:function(a){return e.showDeleteConfirm(t.id)}}},[e._v("删除")])]}}])})],1)],1)],1)],1)},s=[],r=(a("d81d"),a("b0c0"),a("d3b7"),a("25f0"),a("2af9")),o=(a("99af"),a("b775")),i=a("365c");function l(e){return Object(o["b"])({url:i["a"].User,method:"get",params:e})}function c(e){return Object(o["b"])({url:i["a"].User,method:"post",data:e})}function d(e,t){return Object(o["b"])({url:"".concat(i["a"].User,"/").concat(e),method:"put",data:t})}function u(e){return Object(o["b"])({url:"".concat(i["a"].User,"/").concat(e),method:"delete"})}var p=[{title:"账号名",dataIndex:"nickname"},{title:"登录账号",dataIndex:"name"},{title:"部门",scopedSlots:{customRender:"dept"}},{title:"状态",scopedSlots:{customRender:"status"}},{title:"操作",scopedSlots:{customRender:"tools"}}],m={data:function(){var e=this;return{description:"",visible:!1,loading:!1,confirmLoading:!1,pagination:{},data:[],rules:[],roles:[],depts:[],expandedKeys:[],autoExpandParent:!0,checkedKeys:[],selectedKeys:[],form:this.$form.createForm(this),columns:p,selected:0,queryParam:{},loadData:function(t){return l(Object.assign(t,e.queryParam)).then((function(t){t=t.result;var a=t,n=a.users,s=a.roles,r=a.rules,o=a.depts;return e.rules=r,e.roles=s,e.depts=o,e.expandedDept(o),n}))},selectedRowKeys:[],selectedRows:[]}},components:{STable:r["r"]},mounted:function(){},methods:{openInfoModal:function(e){var t=this;this.visible=!0,this.selected=e.id,this.$nextTick((function(){t.form.setFieldsValue({name:e.name,nickname:e.nickname,status:e.status,dept_id:e.dept_id,roles:e.roles.map((function(e){return e.id.toString()}))})}))},handleSubmit:function(){var e=this;this.form.validateFields((function(t,a){if(!t){e.confirmLoading=!0;var n=0===e.selected?c(a):d(e.selected,a);n.then((function(t){e.$notification["success"]({message:"成功通知",description:0===e.selected?"添加成功！":"更新成功！"}),e.refreshTable(),e.handleCancel()})).finally((function(){e.confirmLoading=!1}))}}))},refreshTable:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$refs.table.refresh(e)},handleCancel:function(){this.visible=!1,this.form.resetFields(),this.selected=0},showDeleteConfirm:function(e){var t=this;this.$confirm({title:"确定删除此用户吗?",content:"",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){u(e).then((function(e){t.$notification["success"]({message:"成功通知",description:"删除成功！"}),t.refreshTable()}))}})},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},handleMenuClick:function(){},expandIcon:function(e){var t=e.expanded,a=this.$createElement;return a("a-icon",!0===t?{attrs:{type:"down"}}:{attrs:{type:"right"}})},onSelect:function(e,t,a){var n=this;if(t.dataRef.children.length>0)return this.$message.info("不能选择父节点"),this.$nextTick((function(){n.form.setFieldsValue({dept_id:null})})),!1},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},onCheck:function(e){this.checkedKeys=e},onSelects:function(e,t){var a=t.node.value;this.selectedKeys=e,Object.assign(this.queryParam,{deptPid:a}),this.refreshTable(!0)},expandedDept:function(e){var t=this;e.map((function(e){t.expandedKeys.push(e.value),void 0!==e.children&&t.expandedDept(e.children)}))}}},f=m,h=(a("9898"),a("2877")),v=Object(h["a"])(f,n,s,!1,null,null,null);t["default"]=v.exports},5026:function(e,t,a){},9898:function(e,t,a){"use strict";var n=a("5026"),s=a.n(n);s.a}}]);